/* 
 * Wallpaper v3.1.0 - 2014-03-29 
 * A jQuery plugin for smooth-scaling image and video backgrounds. Part of the Formstone Library. 
 * http://formstone.it/wallpaper/ 
 * 
 * Copyright 2014 Ben Plum; MIT Licensed 
 */ 

!function(a,b){"use strict";function c(b){var c=a.extend({},y,b);p=a("body"),q=o(),r=q!==!1,r||(q="transitionend.wallpaper");for(var e=a(this),f=0,g=e.length;g>f;f++)d.apply(e.eq(f),[a.extend({},c)]);return p.hasClass("wallpaper-inititalized")||(p.addClass("wallpaper-inititalized"),s.on("resize.wallpaper",c,l)),e}function d(b){var c=a(this);if(!c.hasClass("wallpaper")){a.extend(b,c.data("wallpaper-options")),c.addClass("wallpaper loading").append('<div class="wallpaper-container"></div>'),b.guid="wallpaper-"+u++,b.$target=c,b.$container=b.$target.find(".wallpaper-container"),b.$target.data("wallpaper",b).on("resize.wallpaper",b,k);var d=b.source;b.source=null,e(d,b),b.onReady.call()}}function e(a,b){if(b.source!==a){if(b.source=a,"string"==typeof a){var c=a.match(/^.*(?:youtu.be\/|v\/|e\/|u\/\w+\/|embed\/|v=)([^#\&\?]*).*/);b.isYouTube=c&&c.length>=1}b.isYouTube?(b.playing=!1,b.posterLoaded=!1,h(a,b)):"object"==typeof a?g(a,b):f(a,b)}else b.$target.trigger("wallpaper.loaded"),b.onLoad.call(b.$target)}function f(b,c,d){var e=a('<div class="wallpaper-media wallpaper-image"><img /></div>'),f=e.find("img");f.one("load.wallpaper",function(){t&&e.addClass("native").css({backgroundImage:"url("+b+")"}),e.on(q,function(b){n(b),a(b.target).is(e)&&(e.off(q),d||i(c))}),setTimeout(function(){e.css({opacity:1})},50),k({data:c}),d||(c.$target.trigger("wallpaper.loaded"),c.onLoad.call(c.$target))}).attr("src",b),c.$container.append(e),(f[0].complete||4===f[0].readyState)&&f.trigger("load.wallpaper")}function g(b,c){if(c.source.poster&&f(c.source.poster,c,!0),!x){var d='<div class="wallpaper-media wallpaper-video">';d+="<video",c.loop&&(d+=" loop"),c.mute&&(d+=" muted"),d+=">",c.source.webm&&(d+='<source src="'+c.source.webm+'" type="video/webm" />'),c.source.mp4&&(d+='<source src="'+c.source.mp4+'" type="video/mp4" />'),c.source.ogg&&(d+='<source src="'+c.source.ogg+'" type="video/ogg" />'),d+="</video>",d+="</div>";var e=a(d),g=e.find("video");g.one("loadedmetadata.wallpaper",function(){e.on(q,function(b){n(b),a(b.target).is(e)&&(e.off(q),i(c))}),setTimeout(function(){e.css({opacity:1})},50),k({data:c}),c.$target.trigger("wallpaper.loaded"),c.onLoad.call(c.$target),c.hoverPlay?c.$target.on("mouseover.boxer",z.play).on("mouseout.boxer",z.pause):c.autoPlay&&this.play()}),c.$container.append(e)}}function h(c,d){if(!d.videoId){var e=c.match(/^.*(?:youtu.be\/|v\/|e\/|u\/\w+\/|embed\/|v=)([^#\&\?]*).*/);d.videoId=e[1]}if(d.posterLoaded||(d.poster||(d.poster="http://img.youtube.com/vi/"+d.videoId+"/maxresdefault.jpg"),d.posterLoaded=!0,f(d.poster,d,!0)),!x)if(a("script[src*='www.youtube.com/iframe_api']").length||a("head").append('<script src="'+b.location.protocol+'//www.youtube.com/iframe_api"></script>'),v){var g='<div class="wallpaper-media wallpaper-embed">';g+='<iframe id="'+d.guid+'" type="text/html" src="',g+=b.location.protocol+"//www.youtube.com/embed/"+d.videoId+"/",g+="?controls=0&rel=0&showinfo=0&enablejsapi=1&version=3&&playerapiid="+d.guid,d.loop&&(g+="&loop=1"),g+="&autoplay=1",g+="&origin="+b.location.protocol+"//"+b.location.host,g+='" frameborder="0" allowfullscreen></iframe>',g+="</div>";var h=a(g);d.$container.append(h),d.player=new b.YT.Player(d.guid,{events:{onReady:function(){d.$target.find(".wallpaper-embed").addClass("ready"),d.player.setPlaybackQuality("highres"),d.mute&&d.player.mute(),d.hoverPlay&&d.$target.on("mouseover.boxer",z.play).on("mouseout.boxer",z.pause)},onStateChange:function(a){d.playing||a.data!==b.YT.PlayerState.PLAYING||(d.playing=!0,(d.hoverPlay||!d.autoPlay)&&d.player.pauseVideo(),d.$target.trigger("wallpaper.loaded"),d.onLoad.call(d.$target),d.$target.find(".wallpaper-media").css({opacity:1}))}}}),k({data:d})}else w.push({source:c,data:d})}function i(a){var b=a.$container.find(".wallpaper-media");b.length>=1&&b.not(":last").remove()}function j(b){var c=b.$container.find(".wallpaper-media");c.length>=1&&c.on(q,function(d){n(d),a(d.target).is(c)&&(a(this).remove(),delete b.source)}).css({opacity:0})}function k(a){n(a);for(var b=a.data,c=b.$container.find(".wallpaper-media"),d=0,e=c.length;e>d;d++){var f=c.eq(d),g=b.isYouTube?"iframe":f.find("video").length?"video":"img",h=f.find(g);if(h.length&&("img"!==g||!b.nativeSupport)){var i=b.$target.outerWidth(),j=b.$target.outerHeight(),k=m(b,h);b.width=k.naturalWidth,b.height=k.naturalHeight,b.left=0,b.top=0;var l=b.isYouTube?b.embedRatio:b.width/b.height;b.height=j,b.width=b.height*l,b.width<i&&(b.width=i,b.height=b.width/l),b.left=-(b.width-i)/2,b.top=-(b.height-j)/2,f.css({height:b.height,width:b.width,left:b.left,top:b.top})}}}function l(){a(".wallpaper").each(function(){var b=a(this).data("wallpaper");k({data:b})})}function m(a,b){if(a.isYouTube)return{naturalHeight:500,naturalWidth:500/a.embedRatio};if(b.is("img")){var c=b[0];if("undefined"!=typeof c.naturalHeight)return{naturalHeight:c.naturalHeight,naturalWidth:c.naturalWidth};var d=new Image;return d.src=c.src,{naturalHeight:d.height,naturalWidth:d.width}}return{naturalHeight:b[0].videoHeight,naturalWidth:b[0].videoWidth}}function n(a){a.preventDefault&&(a.stopPropagation(),a.preventDefault())}function o(){var a={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},b=document.createElement("div");for(var c in a)if(a.hasOwnProperty(c)&&c in b.style)return a[c]+".wallpaper";return!1}var p,q,r,s=a(b),t="backgroundSize"in document.documentElement.style,u=0,v=!1,w=[],x=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(b.navigator.userAgent||b.navigator.vendor||b.opera),y={autoPlay:!0,embedRatio:.5625,hoverPlay:!1,loop:!0,mute:!0,onLoad:a.noop,onReady:a.noop,source:null},z={defaults:function(b){return y=a.extend(y,b||{}),a(this)},destroy:function(){var b=a(this).each(function(){var b=a(this).data("wallpaper");b&&(b.$container.remove(),b.$target.removeClass("wallpaper").off(".boxer").data("wallpaper",null))});return a(".wallpaper").length<1&&(p.removeClass("wallpaper-inititalized"),s.off(".wallpaper")),b},load:function(b){return a(this).each(function(){var c=a(this).data("wallpaper");c&&e(b,c)})},pause:function(){return a(this).each(function(){var b=a(this).data("wallpaper");if(b)if(b.isYouTube&&b.player)b.player.pauseVideo();else{var c=b.$container.find("video");c.length&&c[0].pause()}})},play:function(){return a(this).each(function(){var b=a(this).data("wallpaper");if(b)if(b.isYouTube&&b.player)b.player.playVideo();else{var c=b.$container.find("video");c.length&&c[0].play()}})},stop:function(){z.pause.apply(this)},unload:function(){return a(this).each(function(){var b=a(this).data("wallpaper");b&&j(b)})}};b.onYouTubeIframeAPIReady=function(){v=!0;for(var a in w)w.hasOwnProperty(a)&&h(w[a].source,w[a].data);w=[]},a.fn.wallpaper=function(a){return z[a]?z[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:c.apply(this,arguments)},a.wallpaper=function(a){"defaults"===a&&z.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery,window);