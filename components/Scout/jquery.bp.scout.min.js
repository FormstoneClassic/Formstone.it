/*
 * Scout Plugin - Simple Google Analytics Events
 * @author Ben Plum
 * @version 0.1.1
 *
 * Copyright (c) 2013 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 *
 */

if(jQuery)(function(c){function j(b){e=c("body");c.extend(g,b);if(!e.data("scouting")){e.find("a").not("[data-scout-event]").each(k);e.data("scouting",!0).on("click.scout","*[data-scout-event]",l);for(var a in c.scout.extensions)c.scout.extensions[a](g.extensions[a]||null)}}function l(b){b.preventDefault();var a=c(this),f=a.attr("href");b=a.data("scout-event").split(",");for(var d in b)b[d]=c.trim(b[d]);h(b[0],b[1],b[2]||f,b[3],b[4]);f&&!a.data("scout-stop")&&setTimeout(function(){a.attr("target")?window.open(f, a.attr("target")):document.location.href=f},g.delay)}function k(){var b=c(this),a="undefined"!=typeof b.attr("href")?b.attr("href"):"",f=a.match(document.domain.split(".").reverse()[1]+"."+document.domain.split(".").reverse()[0]),d;a.match(/^mailto\:/i)?d="Email, Click, "+a.replace(/^mailto\:/i,""):a.match(/^tel\:/i)?d="Telephone, Click, "+a.replace(/^tel\:/i,""):a.match(g.filetypes)?d="File, Download:"+(/[.]/.exec(a)?/[^.]+$/.exec(a):void 0)[0]+", "+a.replace(/ /g,"-"):a.match(/^https?\:/i)&&!f&& (d="ExternalLink, Click, "+a.replace(/^https?\:\/\//i,""));b.attr("data-scout-event",d)}function h(b,a,c,d,e){"undefined"==typeof _gaq&&(_gaq=[]);_gaq.push(["_trackEvent",b,a,c,d,e])}var g={delay:100,extensions:{},filetypes:/\.(zip|exe|dmg|pdf|doc.*|xls.*|ppt.*|mp3|txt|rar|wma|mov|avi|wmv|flv|wav)$/i},e;c.scout=function(){arguments.length&&"object"!==typeof arguments[0]?h.apply(this,arguments):j.apply(this,arguments)};c.scout.extensions={}})(jQuery);