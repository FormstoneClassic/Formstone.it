/* 
 * Roller v3.0.12 - 2014-02-06 
 * A jQuery plugin for simple content carousels. Part of the Formstone Library. 
 * http://formstone.it/roller/ 
 * 
 * Copyright 2014 Ben Plum; MIT Licensed 
 */ 

!function(a,b){"use strict";function c(b){b=a.extend({},s,b);for(var c=a(this),e=0,f=c.length;f>e;e++)d(c.eq(e),b);return c}function d(c,d){if(!c.data("roller")){d=a.extend({},d,c.data("roller-options")),d.single||(c.find(".roller-canister").length||(c.wrapInner('<div class="roller-canister"></div>'),d.canister=!0),c.find(".roller-viewport").length||(c.wrapInner('<div class="roller-viewport"></div>'),d.viewport=!0));var f="";d.controls&&!c.find(".roller-controls").length&&(f+='<div class="roller-controls">',f+='<span class="roller-control previous">Previous</span>',f+='<span class="roller-control next">Next</span>',f+="</div>"),d.pagination&&!c.find(".roller-pagination").length&&(f+='<div class="roller-pagination">',f+="</div>"),c.addClass("roller "+(d.single?"single ":"")+d.customClass).append(f);var g=a.extend({},{$roller:c,$viewport:c.find(".roller-viewport").eq(0),$canister:c.find(".roller-canister").eq(0),$captions:c.find(".roller-captions").eq(0),$controls:c.find(".roller-controls").eq(0),$pagination:c.find(".roller-pagination").eq(0),index:0,deltaX:null,deltaY:null,leftPosition:0,xStart:0,yStart:0,enabled:!1,touchstart:0,touchEnd:0},d);if(g.$items=g.single?g.$roller.find(".roller-item"):g.$canister.children(".roller-item"),g.$captionItems=g.$captions.find(".roller-caption"),g.$controlItems=g.$controls.find(".roller-control"),g.$paginationItems=g.$pagination.find(".roller-page"),g.$images=g.$canister.find("img"),g.totalImages=g.$images.length,c.data("roller",g),void 0!==b.matchMedia&&(g.maxWidth=1/0===g.maxWidth?"100000px":g.maxWidth,g.mediaQuery=b.matchMedia("(min-width:"+g.minWidth+") and (max-width:"+g.maxWidth+")"),g.mediaQuery.addListener(function(){n.apply(g.$roller)}),n.apply(g.$roller)),g.totalImages>0){g.loadedImages=0;for(var h=0;h<g.totalImages;h++){var j=g.$images.eq(h);j.one("load.roller",g,e),(j[0].complete||j[0].height)&&j.trigger("load.roller")}}(g.autoAdvance||g.auto)&&(g.autoTimer=q(g.autoTimer,g.autoTime,function(){i(g)},!0))}}function e(a){var b=a.data;b.loadedImages++,b.loadedImages===b.totalImages&&t.resize.apply(b.$roller)}function f(a){a.stopPropagation();var b=a.data;r(b.autoTimer),b.touchStart=(new Date).getTime(),b.$canister.css(p("transition","none"));var c="undefined"!=typeof a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:null;b.xStart=c?c.pageX:a.clientX,b.yStart=c?c.pageY:a.clientY,b.$canister.on("touchmove.roller",b,g).one("touchend.roller touchcancel.roller",b,h)}function g(a){a.stopPropagation();var b=a.data,c="undefined"!=typeof a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:null;b.deltaX=b.xStart-(c?c.pageX:a.clientX),b.deltaY=b.yStart-(c?c.pageY:a.clientY),(b.deltaX<-10||b.deltaX>10)&&a.preventDefault(),b.touchLeft=b.leftPosition-b.deltaX,b.touchLeft>0&&(b.touchLeft=0),b.touchLeft<b.maxMove&&(b.touchLeft=b.maxMove),b.useMargin?b.$canister.css({marginLeft:b.touchLeft}):b.$canister.css(p("transform","translate3d("+b.touchLeft+"px, 0, 0)"))}function h(a){var b=a.data;b.touchEnd=(new Date).getTime(),b.leftPosition=b.touchLeft,b.$canister.css(p("transition","")),b.$canister.off("touchmove.roller touchend.roller touchcancel.roller");var c=o(b);b.touchPaged&&!b.swipe?l(b,c):(b.index=c,m(b)),b.deltaX=null,b.touchStart=0,b.touchEnd=0}function i(a){var b=a.index+1;b>a.pageCount&&(b=0),l(a,b)}function j(b){b.preventDefault(),b.stopPropagation();var c=b.data,d=c.index+(a(b.currentTarget).hasClass("next")?1:-1);r(c.autoTimer),l(c,d)}function k(b){b.preventDefault(),b.stopPropagation();var c=b.data,d=c.$paginationItems.index(a(b.currentTarget));r(c.autoTimer),l(c,d)}function l(a,b){if(0>b&&(b=0),b>a.pageCount&&(b=a.pageCount),a.single)a.$items.removeClass("active").eq(b).addClass("active");else{if(a.paged){var c=a.$items.eq(b).position();c&&(a.leftPosition=-c.left)}else a.leftPosition=-(b*a.pageMove);a.leftPosition<a.maxMove&&(a.leftPosition=a.maxMove),a.useMargin?a.$canister.css({marginLeft:a.leftPosition}):a.$canister.css(p("transform","translate3d("+a.leftPosition+"px, 0, 0)"))}a.index=b,m(a),a.$roller.trigger("update.roller")}function m(a){if(a.$captionItems.filter(".active").removeClass("active"),a.$captionItems.eq(a.index).addClass("active"),a.$paginationItems.filter(".active").removeClass("active"),a.$paginationItems.eq(a.index).addClass("active"),a.$items.removeClass("visible"),!a.single&&"Infinity"!==a.perPage)for(var b=0;b<a.perPage;b++)a.leftPosition===a.maxMove?a.$items.eq(a.count-1-b).addClass("visible"):a.$items.eq(a.perPage*a.index+b).addClass("visible");a.pageCount<=0?a.$controlItems.removeClass("enabled"):(a.$controlItems.addClass("enabled"),a.index<=0?a.$controlItems.filter(".previous").removeClass("enabled"):(a.index>=a.pageCount||a.leftPosition===a.maxMove)&&a.$controlItems.filter(".next").removeClass("enabled"))}function n(){var b=a(this).data("roller");b.mediaQuery.matches?t.enable.apply(b.$roller):t.disable.apply(b.$roller)}function o(b){if(b.single)return b.index;if((b.deltaX>20||b.deltaX<-20)&&b.touchStart&&b.touchEnd&&b.touchEnd-b.touchStart<200)return b.index+(b.deltaX>0?1:-1);if(b.paged){var c=1/0;if(b.leftPosition===b.maxMove)return b.$items.length-1;var d=0;return b.$items.each(function(e){var f=a(this).position(),g=f.left+b.leftPosition;0>g&&(g=-g),c>g&&(c=g,d=e)}),d}return Math.round(-b.leftPosition/b.viewportWidth)}function p(a,b){var c={};return c["-webkit-"+a]=b,c["-moz-"+a]=b,c["-ms-"+a]=b,c["-o-"+a]=b,c[a]=b,c}function q(a,b,c,d){return r(a,d),d===!0?setInterval(c,b):setTimeout(c,b)}function r(a){null!==a&&(clearInterval(a),a=null)}var s={autoAdvance:!1,autoTime:8e3,autoWidth:!1,controls:!0,customClass:"",duration:500,maxWidth:1/0,minWidth:"0px",paged:!1,pagination:!0,single:!1,touchPaged:!0,useMargin:!1},t={defaults:function(b){return s=a.extend(s,b||{}),a(this)},destroy:function(){return a(this).each(function(){var b=a(this).data("roller");b&&(r(b.autoTimer),b.single||(b.viewport&&b.$items.unwrap(),b.canister?b.$items.unwrap():b.$canister.attr("style",null)),b.$items.removeClass("visible"),b.pagination&&b.$pagination.remove(),b.controls&&b.$controls.remove(),b.$roller.removeClass("roller enabled "+(b.single?"single ":"")+b.customClass).off(".roller").data("roller",null))})},disable:function(){return a(this).each(function(){var b=a(this).data("roller");b&&b.enabled&&(r(b.autoTimer),b.enabled=!1,b.$roller.removeClass("enabled").off("touchstart.roller click.roller"),b.$canister.attr("style","").css(p("transition","none")).off("touchstart.roller"),b.$controls.removeClass("visible"),b.$pagination.removeClass("visible").html(""),b.useMargin?b.$canister.css({marginLeft:""}):b.$canister.css(p("transform","translate3d(0px, 0, 0)")),b.index=0)})},enable:function(){return a(this).each(function(){var b=a(this).data("roller");b&&!b.enabled&&(b.enabled=!0,b.$roller.addClass("enabled").on("touchstart.roller click.roller",".roller-control",b,j).on("touchstart.roller click.roller",".roller-page",b,k),b.$canister.css(p("transition","")),t.resize.apply(b.$roller),b.single||b.$canister.on("touchstart.roller",b,f))})},jump:function(b){return a(this).each(function(){var c=a(this).data("roller");c&&c.enabled&&(r(c.autoTimer),l(c,b-1))})},resize:function(){return a(this).each(function(){var b=a(this).data("roller");if(b&&b.enabled){if(b.count=b.$items.length,b.viewportWidth=b.$viewport.outerWidth(!1),b.itemMargin=parseInt(b.$items.eq(0).css("margin-left"),10)+parseInt(b.$items.eq(0).css("margin-right"),10),b.autoWidth&&b.$items.css({width:b.viewportWidth}),b.single)b.perPage=1,b.pageCount=b.count-1;else if(b.paged){b.canisterWidth=0;for(var c=0;c<b.count;c++)b.canisterWidth+=b.$items.eq(c).outerWidth()+b.itemMargin;b.perPage=1,b.pageCount=b.canisterWidth>b.viewportWidth?b.count-1:0}else b.itemWidth=b.$items.eq(0).outerWidth(!1)+b.itemMargin,b.perPage=Math.floor(b.viewportWidth/b.itemWidth),b.perPage<1&&(b.perPage=1),b.pageCount=Math.ceil(b.count/b.perPage)-1,b.pageMove=b.itemWidth*b.perPage,b.canisterWidth=b.itemWidth*b.count;if(b.maxMove=-b.canisterWidth+b.viewportWidth+b.itemMargin,b.maxMove>0&&(b.maxMove=0),"Infinity"!==b.pageCount){for(var d="",e=0;e<=b.pageCount;e++)d+='<span class="roller-page">'+(e+1)+"</span>";b.$pagination.html(d)}b.pageCount<1?(b.$controls.removeClass("visible"),b.$pagination.removeClass("visible")):(b.$controls.addClass("visible"),b.$pagination.addClass("visible")),b.$paginationItems=b.$roller.find(".roller-page"),b.single||b.$canister.css({width:b.canisterWidth}),l(b,o(b))}})},reset:function(){return a(this).each(function(){var b=a(this).data("roller");b&&b.enabled&&(b.$items=b.$roller.find(".roller-item"),t.resize.apply(b.$roller))})}};a.fn.roller=function(a){return t[a]?t[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:c.apply(this,arguments)},a.roller=function(a){"defaults"===a&&t.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery,window);