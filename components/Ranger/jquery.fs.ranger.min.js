/* 
 * Ranger v3.0.0 - 2014-01-20 
 * A jQuery plugin for cross browser range inputs. Part of the formstone library. 
 * http://formstone.it/ranger/ 
 * 
 * Copyright 2014 Ben Plum; MIT Licensed 
 */ 

!function(a){"use strict";function b(b){b=a.extend({},m,b);for(var d=a(this),e=0,f=d.length;f>e;e++)c(d.eq(e),b);return d}function c(b,c){if(!b.data("ranger")){a.extend(c,b.data("ranger-options")),c.formatter===a.noop&&(c.formatter=l);var f=parseFloat(b.attr("min"))||0,g=parseFloat(b.attr("max"))||100,j=parseFloat(b.attr("step"))||1,m=b.val()||f+(g-f)/2,o='<div class="ranger';c.vertical&&(o+=" ranger-vertical"),c.label&&(o+=" ranger-labels"),o+='">',o+='<div class="ranger-track">',o+='<span class="ranger-handle">',o+='<span class="ranger-disc"></span>',o+="</span>",o+="</div>",o+="</div>",b.addClass("ranger-element").after(o);var p=b.next(".ranger"),q=p.find(".ranger-track"),r=p.find(".ranger-handle"),s=p.find(".ranger-output");c.label&&(c.vertical?p.prepend('<span class="ranger-label max">'+c.formatter.call(this,c.labelMax?c.labelMax:g)+"</span>").append('<span class="ranger-label min">'+c.formatter.call(this,c.labelMin?c.labelMin:f)+"</span>"):p.prepend('<span class="ranger-label min">'+c.formatter.call(this,c.labelMin?c.labelMin:f)+"</span>").append('<span class="ranger-label max">'+c.formatter.call(this,c.labelMax?c.labelMax:g)+"</span>")),p.is(":disabled")&&p.addClass("disabled");var t=a.extend({$input:b,$ranger:p,$track:q,$handle:r,$output:s,min:f,max:g,step:j,stepDigits:j.toString().length-j.toString().indexOf("."),value:m},c);b.on("focus.ranger",t,h).on("blur.ranger",t,i).on("change.ranger input.ranger",t,k).data("ranger",t),p.on("touchstart.ranger mousedown.ranger",".ranger-track",t,d).on("touchstart.ranger mousedown.ranger",".ranger-handle",t,e),n.reset.apply(b)}}function d(b){b.stopPropagation();var c=b.data;f(b),c.$ranger.addClass("focus"),a("body").on("touchmove.ranger mousemove.ranger",c,f).one("touchend.ranger touchcancel.ranger mouseup.ranger",c,g)}function e(b){b.stopPropagation();var c=b.data;c.$ranger.addClass("focus"),a("body").on("touchmove.ranger mousemove.ranger",c,f).one("touchend.ranger touchcancel.ranger mouseup.ranger",c,g)}function f(a){var b=a.data,c=b.$track.offset(),d=0;d=b.vertical?1-(a.pageY-c.top)/b.trackHeight:(a.pageX-c.left)/b.trackWidth,j(b,d)}function g(b){var c=b.data;c.$ranger.removeClass("focus"),a("body").off(".ranger")}function h(a){a.data.$ranger.addClass("focus")}function i(a){a.data.$ranger.removeClass("focus")}function j(a,b){a.increment>1&&(b=a.vertical?Math.round(b*a.stepCount)*a.increment/a.trackHeight:Math.round(b*a.stepCount)*a.increment/a.trackWidth),0>b&&(b=0),b>1&&(b=1);var c=(a.min-a.max)*b;c=-parseFloat(c.toFixed(a.stepDigits)),a.$handle.css(a.vertical?"bottom":"left",100*b+"%"),c+=a.min,c!==a.value&&(a.$input.val(c).trigger("change",[!0]),a.callback.call(a.$ranger,c),a.value=c)}function k(a,b){if(!b){var c=a.data,d=c.$input.val()/(c.max-c.min);j(c,d)}}function l(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}var m={callback:a.noop,customClass:"",formatter:a.noop,label:!0,labels:{max:!1,min:!1},vertical:!1},n={defaults:function(b){return m=a.extend(m,b||{}),a(this)},destroy:function(){return a(this).each(function(b,c){var d=a(c),e=d.data("ranger");"undefined"!=typeof e&&(e.$ranger.off(".ranger").remove(),e.$input.off(".ranger").removeClass("ranger-element").removeData("ranger"))})},disable:function(){return a(this).each(function(b,c){var d=a(c),e=d.data("ranger");"undefined"!=typeof e&&(e.$input.attr("disabled","disabled"),e.$ranger.addClass("disabled"))})},enable:function(){return a(this).each(function(b,c){var d=a(c),e=d.data("ranger");"undefined"!=typeof e&&(e.$input.attr("disabled",null),e.$ranger.removeClass("disabled"))})},reset:function(){return a(this).each(function(b,c){var d=a(c),e=d.data("ranger");if("undefined"!=typeof e){e.stepCount=(e.max-e.min)/e.step,e.vertical?(e.trackHeight=e.$track.outerHeight(),e.handleHeight=e.$handle.outerHeight(),e.increment=e.trackHeight/e.stepCount):(e.trackWidth=e.$track.outerWidth(),e.handleWidth=e.$handle.outerWidth(),e.increment=e.trackWidth/e.stepCount);var f=e.$input.val()/(e.max-e.min);j(e,f)}})}};a.fn.ranger=function(a){return n[a]?n[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:b.apply(this,arguments)},a.ranger=function(a){"defaults"===a&&n.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery,window);